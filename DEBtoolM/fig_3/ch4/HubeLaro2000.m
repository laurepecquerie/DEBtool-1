%% fig:HubeLaro2000
%% bib:HubeLaro2000
%% out:HubeLaro2000

%% coded by Bas Kooijman, 2008/09/07
%% rat weight at constant (size independent) feeding at levels rho * ad lib
%% levels rho = 1, .75, .45 are set in fnv0_iso
%% Rattus norvegivus (Sprague-Dawley) that eat at constant rate
%% HubeLaro2000, as in Leeu2003 p121; t since birth = 35 d

tW100 = [... % weeks, grams
0.0                    156.69578008454488;
0.7874666254591283     184.8609114458431;
1.8863671179530943     243.5035288997133;
2.8995488023483453     302.1627665268198;
3.9219181014801574     368.44980743544085;
4.981577561513591      394.4022576864144;
5.880334828987328      429.10572714542513;
7.023099621335602      452.8621085562322;
7.916629937241591      483.2066806813826;
8.960650545855367      496.0834676263492;
9.929403763440975      517.6925962149679;
10.97473017767233      531.6583300444101;
11.92911083223722      541.2817867132283;
13.05750492611349      553.0540511022136;
14.104136524446188     568.1082135168053;
14.888431722328486     578.8585142074298;
15.929836369093438     589.5537792881613;
16.972511654870985     601.3426638503827;
17.925627885585655     609.8776840309732;
18.876086772684133     616.2306719510802;
19.914881051246404     624.7490798615127;
20.951024201354862     631.0906385047242;
21.902829032805798     638.5320471069026;
22.937660783650536     643.779994171702;
23.888125885911407     650.1381650850717;
24.924303581108596     656.4745328319426;
25.874768683369467     662.8327037453124;
27.08364841861431      670.2242676339382;
27.94190333735849      671.1517248984561;
28.97804027230457      677.488100548405;
29.92985131891789      684.9346921438461;
30.96206648639756      688.0005990450841;
31.998250396757143     694.3421497852174;
32.94740409975428      699.606709120175;
33.899011345112015     707.0533402310067;
34.9378463839254       715.5717402383608;
35.971454471171036     719.7312429118547;
36.99721902348384      717.3498080879264;
37.95045753495186      725.8848045592827;
38.985370806298825     731.1327358179259;
39.929052996221515     732.0384452374916;
40.95612894779805      730.7506219919754;
41.98843185094235      733.82169608032;
42.93774859494394      739.0862238029653;
43.88665773643439      744.3508305563913;
45.008478934390446     750.6757769294447;
45.951263542722955     750.49297873308;
46.90319065492724      757.9343636260243;
48.02370666878197      763.1708814139281;
48.88571409882571      767.3636560462069;
49.920627370172674     772.6115873048501;
50.86169919189267      771.3404395541169;
51.97477305816335      770.0307578205552;
52.921071831451115     773.1185074036824;
53.783486864006015     777.3112030051802;
54.988288005942366     781.4375127506701;
55.845068484418356     781.2713900490884;
56.88520870733308      790.878218641592;
57.83714203469975      798.3247865277989;
58.95373006592568      800.2856525737291;
59.900436441724594     803.3733231260754;
60.85196216658011      810.8199700430631;
61.973777149373774     817.1397334228539;
62.9204835251727       820.2274039752003;
63.864573317606556     821.133034363985;
64.89646861823968      824.2041874831102;
65.84448017813993      828.380286620606;
66.95976302526452      829.2527240813869;
67.98552757757734      826.8712892574586;
68.84361945531704      827.7987781342889;
69.95759711834029      827.5827870099203;
70.98466685475444      826.2897807711415;
71.93398981391843      831.5594914870494;
72.9623709495963       831.3600968266828;
73.90735832362034      833.3542348313979;
75.01521145348565      827.6908387572385;
76.0379580350846       823.1326257937923;
76.97682087595072      819.6793588487164;
78.0052020116286       819.4799641883498;
78.94145448429201      813.8498400729752;
79.97334978492513      816.9209931921007;
80.92266652892674      822.1855209147459;
81.94582071303688      817.6272289205186;
82.91735044741083      841.4157745637552;
83.93879184490844      835.7691330151596;
84.96194602901858      831.2108410209324;
86.06677497300764      823.3654838139923;
86.93180658892764      829.7402195790517;
87.96410949207188      832.8112936673958;
88.9859522769183       827.1593900947566;
89.92049196296922      820.4409164250136;
90.87895742600497      833.3348102302303;
92.00730454446777      845.1018995290309;
92.93441451325938      831.8475923243474;
93.96892018209522      837.0956026137716;
94.99860650187443      837.9846365385546;
96.00869641464638      822.5316927063074;
96.93972193574204      812.5426712570724;
97.8925466295365       821.0725637659469;
98.91962258111303      819.7847405204309;
99.94147158112183      814.1380199410543;
101.04107357354317     801.9337654002538;
102.00084422068028     815.9160877906199;
103.00962894935088     799.3747153732235;
104.10531538946817     783.9051750769744];

tW75 = [...  % weeks, grams
0.0                   152.3207887798525;
0.9392633453007342    168.4825914494613;
1.9289249906735844    207.52782767284816;
2.914707493379856     243.3041421424247;
3.9082890416703986    285.6182922165438;
4.9536160774179905    299.58454434531234;
5.922371159552316     321.19522783190985;
6.885899290118889     338.4470139846469;
7.854654372253213     360.05769747124447;
8.89083455351536      366.39613841542024;
9.850442781164238     380.3790107174251;
10.886623583942628    386.71796996092723;
11.925417240988653    395.2358595720334;
12.96547656491738     404.8432222700195;
13.913365844064293    409.0193451167496;
14.954732216643075    419.71669129786403;
15.907847825841506    428.25119317912834;
17.029706054951248    434.57302185314603;
17.8983691444499      444.2141352938529;
18.931935849928173    448.37312757109856;
20.053794700554164    454.69547454444245;
20.918578025869998    461.0671479320128;
21.949531877080638    463.0472098416545;
22.985671298091667    469.3856586889084;
23.93617343150622     475.7407119032424;
24.971006425383436    480.9896955666944;
25.914975801612655    481.89690456269227;
26.952421649757504    489.3248185937482;
28.071667024599613    493.4677169001619;
29.018208494845346    496.5538641668419;
29.964790725342212    499.6400035304437;
30.997010243435547    502.70953852696545;
32.03057757043006     506.8690491035373;
32.98234288466235     514.3115022074464;
34.01183161834839     515.2057586408823;
34.96114836234999     520.4702863635275;
36.079047792839646    523.5247639878698;
37.024442769374836    525.5188229618042;
38.05805085662046     529.678325635298;
39.00565481400956     533.8545038035747;
39.94974460644342     534.7601341923596;
40.984657877790376    540.0080654510028;
42.016960780934674    543.0791395393471;
42.96456473832378     547.2553177076239;
43.9981728255694      551.4148203811176;
45.02917054461234     553.3974658843125;
45.97587070524889     556.4799534433962;
47.00776600588201     559.5511065625215;
48.03875750976257     561.5285690724537;
48.98546388556149     564.6162396248001;
49.93086507725907     566.6154815919969;
51.047453108484994    568.576347637927;
51.98721974610366     566.2167713020444;
53.024743385653316    573.6415597309867;
53.88193146664047     573.475357998624;
54.99983089713012     576.5298356229663;
56.03082861617307     578.5124811261611;
56.97581599019709     580.5066191308763;
57.91990578263095     581.4122495196611;
58.95351386987657     585.5717521931549;
59.98451158891953     587.5543976963498;
60.930804147044896    590.6369642862145;
62.0473983934332      592.6030133254073;
62.995409953333464    596.7791124629032;
63.85480080001213     598.7898469316203;
64.8897140713591      604.0377781902637;
66.00761350184875     607.092255814606;
66.86741816620096     609.1080942458049;
67.80848377275859     607.8317635018088;
68.91985106757915     605.4389152071415;
69.94823220325704     605.2395205467748;
70.89232199569089     606.1451509355595;
71.92070313136877     605.9457562751928;
72.94908426704666     605.7463616148261;
73.89407785623305     607.745682612804;
75.00413375178988     604.2592227397244;
75.94561317602106     602.9879959582101;
76.97660467990163     604.9654584681424;
78.00760239894458     606.9481039713372;
78.94736282140083     604.5833446421921;
79.96790663730829     597.848195477666;
80.99498258888482     596.5603722321498;
81.93776719721734     596.3775740357851;
82.96745351699657     597.2666079605679;
83.91766784258833     603.6196432991436;
84.9486655616313      605.6022888023384;
85.9809622496132      608.6681798974201;
86.92374685794572     608.4853817010554;
88.04164628843536     611.5398593253979;
89.06700945339938     609.1636865255131;
90.01240442993458     611.1577454994475;
91.03817519740977     608.7814936687818;
91.98226498984363     609.6871240575667;
93.01023852301034     609.487808427981;
93.9543283154442      610.3934388167658;
94.98270945112208     610.1940441563991;
96.01109058679997     609.9946494960324;
97.03947172247783     609.7952548356657;
97.97792696083278     606.3420669213709;
99.00630809651065     606.1426722610042;
100.1137536238648     600.4793552176257;
100.97224688895328    601.4015820704124;
101.99018033665806    592.4895757355873;
103.01423210235836    589.0197913572907;
104.0452236062389     590.997253867223];

tW45 = [...  % weeks, grams
0.0                    156.69578008454488;
0.9105169762268215     144.5102110112075;
1.9584574877582899     160.65591180690626;
2.920679191191045      176.81823277584132;
3.9712325569901505     195.14286393914412;
5.004759123733544      199.3023824187941;
6.042245732129512      206.73028854677196;
6.907029678961587      213.1024802336685;
7.8614109550427145     222.7264552018129;
8.893671233387169      225.79598229525652;
9.929852036165558      232.13494153875865;
10.964685030042771     237.3839252022106;
11.911226500288512     240.47007246889052;
12.859115157919186     244.64567701629434;
13.88872182174489      245.5362816452121;
14.926209051657102     252.96470607251624;
15.874056949036659     257.14031852299814;
16.993302323878765     261.28321682941186;
17.85155227049303      262.20652769931974;
19.055209404783803     265.2428223493689;
19.913459972914303     266.16665151860303;
20.94437244235759      268.1462030319965;
21.8883010583357       269.0534199310724;
22.921867763813964     273.212412208318;
23.867102806925892     275.209094291196;
24.899363085270345     278.2786213846397;
25.927703460697103     278.0792346273511;
27.045641786889156     281.1321494506366;
28.07655487784868      283.11221926335634;
28.938725348896874     287.30496228332265;
30.051436723521178     285.99897977274765;
31.082390574731818     287.97904168238927;
31.939334094212263     287.8128873684951;
33.062499371972066     295.22469952564103;
34.08936965774431      293.9353608975367;
35.03476774186069      295.9320113681023;
36.06576235332245      297.9120653746658;
37.09544991613415      298.80213589810114;
37.95353744326019      299.72599667964766;
39.070127960551055     301.68893592288293;
40.09850909622894      301.48954126251624;
40.95921009913885      304.592850710993;
42.07359536467327      304.3767805558433;
42.93690922185082      309.65902037192404;
44.05219331200788      310.5324944313574;
45.08057444768576      310.3330997709907;
45.94258187772949      314.52587440326937;
47.05655954075273      314.3098832789007;
47.999344149085246     314.12708508253604;
48.94474161168539      316.1232172537754;
50.056106420441        313.7282957618027;
51.088407459036574     316.7978149521683;
52.030784464857916     316.61509578658456;
53.065698979237375     321.8640636438804;
54.008483587569884     321.68126544751567;
54.953473447658865     323.6774766495359;
55.89887153177526      325.6741271201015;
57.01284919479849      325.4581359957328;
58.04253737912644      326.3487248184943;
58.90193071187005      328.3615324845166;
60.01721542354335      329.2355248432762;
60.96261288614352      331.2316570145155;
61.99230107047144      332.1222458372771;
62.93639210593777      333.0289128247144;
63.965672687754534     333.9195806782569;
64.91237719900475      337.0056963326244;
66.02635486202799      336.7897052082557;
67.05342894905581      335.5003270647608;
67.99229365447063      332.04861501766396;
69.0206747901485       331.84922035729727;
70.0512617990991       333.8293533946418;
70.9940464074316       333.6465551982771;
72.02112111597566      332.35769535410844;
72.96390572430818      332.17489715774377;
73.98795873304097      328.70614937809955;
74.93205039002353      329.6133346648631;
75.95781804991753      327.23449133756617;
76.90060265825005      327.0516931412015;
78.01458032127329      326.83570201683284;
78.9595708028785       328.83243151817936;
79.89974193542716      326.4701846548844;
81.0137195984504       326.25419353051575;
82.04340716126208      327.14426405395113;
83.07178829693996      326.94486939358444;
84.01939225432906      331.1210475618612;
85.13336991735231      330.90505643749253;
86.16305748016401      331.79512696092786;
87.10845556428038      333.7917774314934;
88.13945017574213      335.77183143805695;
88.9949242270843       334.5162435526732;
90.02330536276219      334.3168488923065;
91.13858945291923      335.19032295173986;
92.169584064381        337.17037695830345;
93.02375106707309      334.8248055897914;
94.05343862988481      335.71487611322675;
94.9949168110835       334.44261273306006;
96.02199151962756      333.1537528888914;
97.05167908243924      334.0438234123267;
97.99274966112678      332.77163906294095;
99.02113079680466      332.57224440257437;
99.96522183227098      333.47891139001166;
101.08050592242806     334.352385449445;
102.1062742038383      331.9740604214743;
103.04603773387578     329.6118925889603;
104.06919191798588     325.0536005947332];

tW100(:,1) = 35 + tW100(:,1) * 7; % convert weeks to days since birth
tW75(:,1) = 35 + tW75(:,1) * 7;   % convert weeks to days since birth
tW45(:,1) = 35 + tW45(:,1) * 7;   % convert weeks to days since birth

dV = 1; % g/cm^3, spec density
w = 0.93908; % -, contribution of reserve to weight
V0 = 73.66385; % g, initial structural volume
v = .31741; % cm/d, energy conductance
kM = 0.00589; % 1/d, somatic maintenance rate coefficient
g = 7.0986; % -, energy investment ratio
LT = 0; % cm, heating length

p = [dV 0; w 1; V0 1; v 1; kM 1; g 1; LT 1];
partxt= {'dV'; 'w'; 'V0'; 'v'; 'kM'; 'g'; 'LT'};

nmregr_options('max_step_number',5000);
nmregr_options('max_fun_evals',10000);
%% p = nmregr('fnv0_iso', p, tW100, tW75, tW45);
[cov, cor, sd] = pregr('fnv0_iso', p, tW100, tW75, tW45);
printpar(partxt,p,sd);

t=linspace(35,770,100)';
[W100, W75, W45] = fnv0_iso(p(:,1),t,t,t);

%% p0 = nmregr('fnv0', p, tW100, tW75, tW45);
%% [cov, cor, sd] = pregr('fnv0', p0, tW100, tW75, tW45);
%% printpar(partxt,p0,sd);
%% [W100_0, W75_0, W45_0] = fnv0(p0(:,1),t,t,t);

%% gset term postscript color solid 'Times-Roman' 35
%% gset output 'Hubelaro2000.ps'

%% gset nokey
%% gset xtics 200
%% gset ytics 200
plot(tW100(:,1), tW100(:,2),'or', t, W100, 'r', ... % t, W100_0, 'm', ...
     tW75(:,1), tW75(:,2), 'og', t, W75, 'g', ...   % t, W75_0, 'm', ...
    tW45(:,1), tW45(:,2), 'ob', t, W45, 'b')        %, t, W45_0, 'm')
legend('100 %', '', '75 %', '',  '45 %', '')
xlabel('time, d')
ylabel('weight, g')
