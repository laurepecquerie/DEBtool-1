%% fig:tLDMD
%% bib:ZonnKooy89
%% out:tdld,tdmd
%% time to death by starvation in Lymnaea stagnalis 

%% long-day snails
lt_ld = [3.1600  34.0000;
   3.1100  33.0000;
   3.0300  34.0000;
   3.1000  28.0000;
   3.2000  35.9999;
   3.1600  30.9999;
   3.1600  34.0000;
   3.1500  37.9998;
   3.1000  28.0000;
   3.1100  33.0000;
   3.2000  28.0000;
   3.2600  46.9999;
   3.0700  30.9999;
   3.2800  22.0000;
   3.2000  35.9999;
   2.8600  36.9999;
   2.8800  33.0000;
   3.0000  33.0000;
   2.9900  40.0000;
   3.0300  25.9999;
   2.8900  46.0000;
   2.9200  40.0000;
   2.8200  40.9999;
   2.8500  30.9999;
   2.9600  33.0000;
   3.0100  40.0000;
   2.9900  33.0000;
   2.8700  34.0000;
   2.8900  33.0000;
   2.8100  36.9999;
   2.6500  46.9999;
   2.5600  42.9999;
   2.6600  40.0000;
   2.6100  33.0000;
   2.6400  42.9999;
   2.6400  40.9999;
   2.6900  40.9999;
   2.6500  37.9998;
   2.5900  43.9998;
   2.7400  33.0000;
   2.2200  37.9998;
   2.2100  35.0000;
   2.2200  35.0000;
   2.1800  35.9999;
   2.2200  40.0000;
   2.1700  41.9999;
   2.3100  30.9999;
   2.3200  43.9998;
   2.2500  40.0000;
   2.1700  36.9999;
   1.7600  34.0000;
   1.7600  45.0000;
   1.8500  35.9999;
   1.7200  46.9999;
   1.8400  43.9998;
   1.8200  45.0000;
   1.6900  35.9999;
   1.7100  30.9999;
   1.8100  40.9999];

%% mid-day snails

lt_md = [ ...
    2.9500   86.9998;
    2.8200   94.0001;
    2.9200   69.0001;
    2.7700  100.9999;
    2.7500   82.9997;
    2.9700   96.9998;
    2.5600   67.9997;
    2.4900   62.9997;
    2.5200   67.9997;
    2.4800   76.9998;
    2.4900   79.0001;
    2.5300   74.0001;
    2.0200   55.9999;
    2.1200   55.9999;
    2.1000   65.0000;
    2.0800   65.0000;
    2.2000   65.9999;
    2.1100   62.9997;
    1.6400   50.9999;
    1.6900   60.0000;
    1.5300   57.9997;
    1.6500   45.0000;
    1.6500   60.9999;
    1.6600   57.9997];

%% mid-day large individuals with shell deformations
lt_md1 = [ ...  % excluded from fit
   3.3300  54.0001;
   3.2500  67.9997;
   3.2100  60.0000;
   3.2800  71.9998;
   3.3500  57.9997;
   3.3100  89.0001];

nmregr_options('report',0);
p_ld = [.05 1; 5.3 1];
p_ld = nmregr('starve_time_ld', p_ld, lt_ld);
[cov cor sd] = pregr('starve_time_ld', p_ld, lt_ld);
p_txt = {'k_M g';'e(0)/\kap'};
printpar(p_txt,p_ld,sd);

l_ld = linspace(1e-8,3.5,100)';
t_ld = starve_time_ld (p_ld(:,1), l_ld);

p_md = [.049 0; .8 1; .7 1];
p_md = nmregr('starve_time_md', p_md, lt_md);
[cov cor sd] = pregr('starve_time_md', p_md, lt_md);
p_txt = {'k_M g';'kap'; 'fc'};
printpar(p_txt,p_md,sd);

l_md = linspace(1e-8,3.5,100)';
t_md = starve_time_md (p_md(:,1), l_md);
nmregr_options('report',0);

%% gset term postscript color solid 'Times-Roman' 35

subplot(1,2,1);
plot(lt_ld(:,1), lt_ld(:,2), '.g', l_ld, t_ld, '-r')
title('long day')
xlabel('length, cm')
ylabel('time, d')

subplot(1,2,2);
plot(lt_md(:,1), lt_md(:,2), '.g', ...
     lt_md1(:,1), lt_md1(:,2), '.b', l_md, t_md, '-r')
title('mid day')
xlabel('length, cm')
ylabel('time, d')
