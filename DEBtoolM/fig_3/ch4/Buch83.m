%% fig:Buch83
%% bib:Buch83
%% out:Buch83,Buch83r

%% embryo weigth and dioxygen consumption as function of age in
%% Agapornis personata

aW = [11.70990271 0.5419996482;
      11.71885792 0.4272995307;
      16.56067555 1.227115195;
      17.80011983 1.2187855;
      17.89615962 1.342127578;
      18.70513719 1.542477768;
      18.80156711 1.484741545;
      19.54984796 1.701477864;
      19.57954275 1.756867833;
      20.00723891 1.327012843;
      20.47852169 2.177300161;
      20.81088072 2.394039271;
      21.04784352 1.709210868;
      21.32973915 2.296235516;
      21.70837672 2.406692022];
%% high weight coefficients because of small numbers
%%   compared to respiration data
aW = [aW, 40*ones(15,1)];

aO2 = [5.069234616 2.424503553;
       5.807869553 2.789312066;
       7.715148029 7.803996499;
       7.744600789 4.484309446;
       7.777859646 5.34718559;
       7.941513958 5.249967402;
       7.994321604 7.203424656;
       8.777002057 6.312528994;
       9.840329931 9.461696106;
       10.04832129 8.051514817;
       10.49524681 11.47902906;
       10.56379714 10.34050422;
       10.63555433 8.572131188;
       11.00603387 7.293767421;
       11.74585922 14.8199341;
       11.85379057 13.34184794;
       12.00780816 10.2072451;
       12.02764848 11.24056729;
       12.54371549 15.87850347;
       13.0072502  13.57879421;
       13.58487079 18.45241981;
       13.65109698 20.23543103;
       13.66917192 16.68537752;
       13.81327744 15.49757823;
       14.07058617 19.19142595;
       14.10791837 16.78921248;
       14.63478013 21.77203297;
       14.87631378 18.70400427;
       14.96091454 19.34316767;
       14.99651374 22.21143702;
       15.00437699 18.20198135;
       15.0747089  26.57376146;
       15.53707748 24.50308792;
       15.69724151 27.55644149;
       15.76464191 31.57388162;
       16.01024081 22.77729868;
       16.08141493 21.1234435;
       16.51437123 34.68978014;
       16.5505373  32.51660238;
       16.64008599 29.7188994;
       16.77046526 23.83187581;
       16.87403983 28.13960281;
       17.15438762 29.77345988;
       17.72237959 34.07316547;
       17.7728307  29.09430027;
       17.77925249 30.29806849;
       17.78977999 38.0906056;
       17.80027512 36.02928421;
       17.85598999 34.94668757;
       17.89009915 28.24739305;
       18.02983171 27.91847766;
       18.16256751 28.96377654;
       18.63195712 32.90928261;
       18.78365865 35.15968045;
       18.80438976 40.9481551;
       18.81690941 33.55909197;
       18.98817592 41.82700017;
       19.00655049 40.68315236;
       19.15733695 30.78800385;
       19.60050493 44.81374266;
       19.62472632 47.45164555;
       19.68972971 32.21944009;
       19.72095594 35.94659335;
       19.83620796 42.89089251;
       19.86973406 36.30611584;
       20.13026582 44.29704462;
       20.20377219 42.18511802;
       20.62709177 52.71407001;
       20.66150865 50.88444582;
       20.73324155 41.7256789;
       20.7355819  43.73107211;
       20.78226738 46.88696684;
       20.92842172 47.76181968;
       21.06319015 45.94284143;
       21.61978001 42.62178668;
       21.66070773 69.09404161;
       21.74792417 66.75441004;
       21.79422908 42.86945281;
       21.84064732 53.47300035;
       21.8666017  50.84042042;
       21.91072008 71.75589789;
       21.9492184  69.12464871;
       21.99118272 55.9524339;
       22.30246522 61.37070316;
       22.37312104 79.53908285;
       22.63498093 47.82828296;
       22.63881941 61.86470466;
       22.76229097 84.45000623;
       22.90697955 83.14768908;
       23.00204305 71.87167259;
       23.01580169 86.42475538;
       23.05487498 81.21552372];

aO2 = [aO2, [ones(75,1); zeros(17,1)]]; % exclude pipping from fit

par_txt = {'Arrhenius temp'; 'ultimate body temp'; ...
	   'environ temp'; 'von Bert gr at Ti'; ...
	   'maint in heating'; 'growth in heating'; ...
           'body weight if l = 1'; 'initial scaled length'; ...
           'maint in respiration'; 'growth in respiration'};
p = [10000 0; (273 + 39) 0; ...
     (273 + 30) 0; .0317 0; ...
     160 0; 550 0; ...
    134 1; .01 0; ...
    150 0; 600 0];
p = nmregr('embryo_lT', p, aW, aO2); sd = zeros(10,1);
[cov cor sd] = pregr('embryo_lT', p, aW, aO2);
printpar(par_txt,p,sd);

a = linspace(1e-6,24,100)';
[W O2 Tb] = embryo_lT(p(:,1), a, a);
aTb = [a, Tb - 273];

%% gset term postscript color solid  'Times-Roman' 35
subplot(1,3,1);
plot(aW(:,1), aW(:,2), '.g', a, W, '-r')
xlabel('time, d')
ylabel('embryo wey weight, g')

subplot(1,3,2);
plot(aO2(:,1), aO2(:,2), '.g', a, O2, '-r')
xlabel('time, d')
ylabel('dioxygen consumption, ml/d')

subplot(1,3,3);
plot(aTb(:,1), aTb(:,2), '-r')
xlabel('time, d')
ylabel('body temperature, C')
