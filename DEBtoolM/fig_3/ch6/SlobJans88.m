%% fig:SlobJans88;
%% bib:SlobJans88,BohlJoos82,ZonnKooy89
%% out:SlobJans88a,SlobJans88l
%% survival prob and lengths of Lymnaea stagnalis

aS = [89.92594801 0.9959453046;
      96.56351905 0.9926548978;
      104.011651  0.9869984529;
      107.5969786 0.9841922392;
      113.1410448 0.9827533916;
      118.3912325 0.9796830726;
      122.3763732 0.9751353436;
      125.2734764 0.9729976702;
      130.7956735 0.9693248373;
      133.7037113 0.9683041565;
      137.2781043 0.9643809502;
      141.7013293 0.9620011802;
      145.8197411 0.9568729461;
      160.2375936 0.9534670401;
      161.2764255 0.9460305175;
      163.3575006 0.9457003858;
      170.4461465 0.9317105136;
      185.1086719 0.924909612;
      191.9690468 0.9159902243;
      192.0476449 0.9098247559;
      194.9283462 0.9060115935;
      204.0030672 0.8961815689;
      205.8852637 0.8897299863;
      211.8018066 0.8837571417;
      215.0003117 0.869825019;
      216.1286764 0.8573400207;
      218.7100319 0.8513368906;
      220.7419013 0.8459802919;
      223.3396587 0.8416526507;
      226.8867153 0.8349369628;
      228.2030239 0.8274564226;
      230.4631644 0.8170293394;
      232.9276507 0.8132822034;
      235.73181   0.8016500923;
      235.8302212 0.8117030263;
      236.6373709 0.7947940749;
      237.3823242 0.7857260809;
      238.1546141 0.7794505686;
      240.3197546 0.7735134648;
      241.5868575 0.7610064577;
      243.8798018 0.7539303525;
      245.207045  0.747566805;
      246.9122321 0.7372277569;
      251.4632608 0.7337089854;
      253.4055975 0.7334008625;
      256.0033549 0.7290732213;
      257.5021402 0.7260386431;
      259.1451311 0.7235405524;
      260.3445705 0.7183160064;
      261.2282622 0.7092260036;
      263.2710662 0.7049863976;
      265.1990572 0.6890183686;
      265.2865338 0.6979543099;
      267.2309266 0.6836617699;
      268.9907867 0.6789076851;
      270.018684  0.6703541699;
      271.3349926 0.6628736298;
      273.9546192 0.6607799739;
      275.0317221 0.6572529257;
      276.5195728 0.6531013548;
      278.2575637 0.6461132846;
      279.606676  0.6419837225;
      281.2059286 0.6350176612;
      282.5550409 0.630888099;
      284.597845  0.626648493;
      285.5307423 0.6225849572;
      287.246864  0.6133629018;
      289.8282195 0.6073597716;
      291.7541544 0.6053761597;
      293.391678  0.6023195726;
      296.0789681 0.5929434557;
      297.2838748 0.588277406;
      298.6275199 0.5835893476;
      299.5330807 0.5767333301;
      300.5773799 0.5698553039;
      302.8429877 0.559986717;
      303.1607915 0.5498677567;
      305.8808854 0.5438426178;
      315.1107465 0.5356660734;
      316.065513  0.533836523;
      319.5688313 0.5226528644;
      320.2351865 0.5197503388;
      321.2794857 0.5128723126;
      324.6385983 0.5011521665;
      326.5590659 0.4986100582;
      326.7490659 0.4896300993;
      327.6327576 0.4805400966;
      328.5547204 0.4753595681;
      331.5796273 0.4720828933;
      334.9988802 0.4665062068;
      336.9084132 0.4628471058;
      339.628507  0.4568219669;
      341.671311  0.4525823609;
      344.6688816 0.4465132043;
      347.6883212 0.4426780332;
      348.4496765 0.4352855282;
      351.3194432 0.4303553731;
      358.1634162 0.4197604964;
      360.0565473 0.4144259065;
      361.3345849 0.4030358921;
      362.5340243 0.3978113461;
      364.949305  0.389037743;
      365.0572957 0.3716803392;
      365.1557069 0.3817332732;
      367.9215951 0.3661916878;
      372.1951472 0.362716934;
      375.6253346 0.3582572401;
      376.958045  0.352452189;
      378.2852882 0.3460886415;
      380.1674847 0.339637058;
      383.2709898 0.3301949157;
      385.0089807 0.3232068456;
      386.6137006 0.3167992805;
      389.1731869 0.3085621651;
      391.4551966 0.3003690671;
      392.9211781 0.2939835109;
      394.5149634 0.2864589532;
      395.7089355 0.2806759109;
      398.8507117 0.2751432419;
      403.9293573 0.2687439537;
      407.5768812 0.2580967827;
      409.8643581 0.2504621811;
      412.4457136 0.2444590509;
      415.9873029 0.2371848666;
      418.6964622 0.230042735;
      421.4274906 0.2251345887;
      423.8591732 0.2180364747;
      427.1506223 0.2135987896;
      429.9766507 0.2042006639;
      431.5923051 0.1989100916;
      434.4784738 0.1956554255;
      437.0707639 0.190769288;
      439.1135679 0.1865296819;
      442.821232  0.1820259705;
      445.7347371 0.1815637861;
      448.6099711 0.1771921274;
      453.2505325 0.1686248802;
      455.7314207 0.1665532331;
      457.7578229 0.1606381381;
      459.0686642 0.1525991016;
      462.0607674 0.1459714488;
      464.9031978 0.1382488121;
      466.8072634 0.1340312148;
      470.316049  0.1234060525;
      472.7914699 0.1207759091;
      476.2216573 0.1163162153;
      478.958153  0.1119665653;
      493.2775943 0.0985077254;
      493.9002112 0.0911372292;
      496.8813799 0.0833925837;
      500.8883898 0.08107884003;
      501.8595582 0.08092477856;
      507.6537646 0.07664943173;
      510.1291855 0.07401928834;
      513.1540925 0.07074261348;
      516.5952145 0.06739991228;
      523.3387201 0.06073651866;
      524.84844   0.05881893307;
      527.6122721 0.05726176476;
      544.5274148 0.05345970069;
      546.4533496 0.05147608875;
      547.6801255 0.04904402439;
      548.9123687 0.04717045637;
      559.5788188 0.04380029116;
      561.7548939 0.03898018;
      563.9473708 0.03583555784;
      563.9473709 0.03583555784;
      570.4298017 0.03089167078;
      576.8958306 0.02427229472;
      578.8108309 0.02117169012;
      590.6657859 0.01145998624;
      609.7658821 0.01793922071;
      672.5302836 0.01357621451];

aL = [ 55.90145234 17.8523408;
       63.25671895 21.36572276;
       70.00024651 22.52342908;
       77.05463452 22.94399613;
       84.15644207 24.76855237;
       91.00033738 26.03443734;
       98.26518495 26.79690698;
      105.728116   27.7414943;
      112.5580256  28.43092997;
      119.2821051  29.33754571;
      126.4196227  29.64373385;
      133.3472481  30.40710854;
      140.4796201  30.25097947;
      147.1348723  31.06074749;
      154.4813983  30.89833587;
      161.3573093  30.99403788;
      168.9291646  31.76139136];

rB = .015; Lm = 35;

Lb = 1e-3;
kM = .073; 
g = 1/ (kM/ 3/ rB - 1); 
v = Lm * g * kM;
ha = 2.08;
sG = 0;
p = [Lb 0; g 1; kM 0; v 1; ha 1; sG 1];

nmregr_options('default');
p = nmregr('bertLS',p, aL, aS);
[cov cor sd ssq] = pregr('bertLS',p, aL, aS);
nm = {'birth length Lb'; 'energy investment ratio g';
      'maint rate coeff kM'; 'energy conductance v';
      'aging acceleration 1e6 * ha'; 'Gompertz coefficient sG'};
printpar(nm,p(:,1),sd);
a_L = linspace(1e-6,170,100)'; a_S = linspace(1e-6,680,100)';
[L, S] = bertLS(p(:,1), a_L, a_S);
pW = [1.1e-2 1; 3 0];
pW = nmregr('weibull', pW, aS);
nmW = {'Weibul rate hW ';'shape coeff beta'};
[covW corW sdW] = pregr('weibull', pW, aS);
printpar(nmW,pW(:,1),sdW);

SW = weibull(pW(:,1),a_S);

%% gset term postscript color solid 'Times-Roman' 35

subplot(1,2,1); 
%% gset output 'SlobJans88l.ps'
plot(aL(:,1), aL(:,2), 'og', a_L, L, 'r');
xlabel('age, d')
ylabel('length, mm')

subplot(1,2,2);
%% gset output 'SlobJans88a.ps'
plot( aS(:,1), aS(:,2), 'og', a_S, S, 'r', a_S, SW, 'b');
xlabel('age, d ')
ylabel('survival probability')



