%% fig:ErnsIsaa91
%% bib:ErnsIsaa91
%% out:ErnsIsaa91,ErnsIsaa91r

%% Survival in Notophilus biguttatus 

%% high feeding level 20/10 centigrade;  time, survival
tN_1 = [ ...
    0  20;
   42  20;
   42  18;
  140  18;
  140  17;
  252  17;
  252  16;
  280  16;
  280  14;
  294  14;
  294  13;
  336  13;
  336  12;
  350  12;
  350  11;
  364  11;
  364  10;
  434  10;
  434   9;
  462   9;
  462   8;
  490   8;
  490   7;
  560   7;
  560   5;
  658   5;
  658   3;
  686   3;
  686   1;
  700   1];

%% high feeding level 20/10 centigrade;  time, reprod
tR_1=[ ...
    0    3.45715;
    8    3.45715;
    8    3.47044;
   14    4.47044;
   14    4.49285;
   26    4.49285;
   26    4.52500;
   28    4.52500;
   28    4.60715;
   37    4.60715;
   37    4.62160;
   42    4.62160;
   42    4.82985;
   46    4.82985;
   46    4.85000;
   55    4.85000;
   55    4.81521;
   56    4.81521;
   56    4.36429;
   66    4.36429;
   66    4.34375;
   70    4.34375;
   70    4.26044;
   75    4.26044;
   75    4.24285;
   83    4.24285;
   83    4.20550;
   84    4.20550;
   84    3.66404;
   88    3.66404;
   88    3.64285;
   96    3.64285;
   96    3.60908;
   98    3.60908;
   98    3.19258;
  105    3.19258;
  105    3.18571;
  112    3.18571;
  112    2.17969;
  116    2.17969;
  116    2.15715;
  124    2.15715;
  124    2.12473;
  126    2.12473;
  126    1.70823;
  133    1.70823;
  133    1.70000;
  140    1.70000;
  140    0.86194;
  142    0.86194;
  142    0.82856;
  150    0.82856;
  150    0.80698;
  154    0.80698;
  154    0.72369;
  155    0.72369;
  155    0.68571;
  168    0.68571;
  168    1.03571;
  182    1.03571;
  182    1.09085;
  190    1.09085;
  190    1.09285;
  196    1.09285;
  196    1.22856;
  221    1.22856;
  221    1.25000;
  238    1.25000;
  238    1.51890;
  239    1.51890;
  239    1.55715;
  247    1.55715;
  252    1.54285;
  261    1.54285;
  266    1.55858;
  267    1.55858;
  267    1.59285;
  276    1.59285;
  276    1.61354;
  280    1.61354;
  280    1.78015;
  284    1.78015;
  284    1.80000;
  293    1.80000;
  293    1.76492;
  294    1.76492;
  294    1.72327;
  301    1.72327;
  301    1.71429;
  308    1.71429; 
  308    1.65715;
  314    1.65715;
  314    1.65927;
  329    1.65927;
  329    1.66429;
  336    1.66429;
  336    2.00000;
  350    2.00000;
  350    1.77267;
  355    1.77267;
  355    1.75715;
  364    1.75715;
  364    1.79656;
  367    1.79656;
  367    1.82144;
  378    1.82144;
  378    1.97646;
  384    1.97646;
  384    1.98571;
  392    1.98571;
  392    1.94002;
  395    1.94002;
  395    1.91429;
  403    1.91429;
  403    1.94350;
  406    1.94350;
  406    2.02681;
  408    2.02681;
  408    2.05715;
  417    2.05715;
  417    2.03252;
  420    2.03252;
  420    1.99088;
  422    1.99088;
  422    1.95715;
  430    1.95715;
  430    1.97835;
  434    1.97835;
  434    3.06127;
  439    3.06127;
  439    3.07856;
  447    3.07856;
  447    3.11621;
  448    3.11621;
  448    3.36613;
  450    3.36613;
  450    3.40000;
  458    3.40000;
  458    3.42106;
  462    3.42106;
  462    3.62931;
  463    3.62931;
  463    3.66429;
  472    3.66429;
  472    3.64431;
  476    3.64431;
  476    3.35275;
  482    3.35275;
  482    3.34285;
  490    3.34285;
  490    2.38150;
  492    2.38150;
  492    2.35000;
  500    2.35000;
  500    2.32654;
  504    2.32654;
  504    1.74344;
  508    1.74344;
  508    1.72144;
  516    1.72144;
  516    1.68850;
  518    1.68850;
  518    1.56354;
  522    1.56354;
  522    1.54285;
  531    1.54285;
  531    1.50858;
  532    1.50858;
  532    1.46694;
  537    1.46694;
  537    1.45000;
  545    1.45000;
  545    1.41200;
  546    1.41200;
  546    1.24540;
  547    1.24540;
  547    1.20715;
  555    1.20715;
  555    1.22385;
  560    1.22385;
  560    1.30715;
  564    1.30715;
  564    1.32856;
  572    1.32856;
  572    1.29504;
  574    1.29504;
  574    1.27144;
  586    1.27144;
  586    1.30000;
  597    1.30000;
  597    1.31606;
  602    1.31606;
  602    1.35771;
  605    1.35771;
  605    1.38571;
  613    1.38571;
  613    1.41267;
  616    1.41267;
  616    1.66256;
  623    1.66256;
  623    1.67144;
  630    1.67144;
  630    1.25050;
  637    1.25050;
  637    1.24285;
  644    1.24285;
  644    1.41512;
  647    1.41512;
  647    1.44285;
  655    1.44285;
  655    1.47008;
  658    1.47008;
  658    2.01152;
  664    2.01152;
  664    2.02144;
  672    2.02144;
  672    2.10812;
  678    2.10812;
  678    2.12144;
  686    2.12144];

%% high feeding level 10 centigrade; survival and reprod apart
tN_2 = [ ...
    0   22;
   42   22;
   42   21;
   70   21;
   70   20;
  140   20;
  140   19;
  168   19;
  168   18;
  378   18;
  378   17;
  476   17;
  476   16;
  518   16;
  518   15;
  532   15;
  532   14;
  546   14;
  546   13;
  560   13;
  560   12;
  602   12;
  602   11;
  644   11;
  644    9;
  714    9;
  714    8;
  728    8;
  728    7;
  784    7;
  784    6;
  938    6;
  938    5;
  994    5];

tR_2 = [ ...
    0    0.55;
   14    0.55;
   14    1.39637;
   17    1.39637;
   17    1.46429;
   28    1.46429;
   28    1.43558;
   33    1.43558;
   33    1.37856;
   42    1.37856;
   42    1.41819;
   45    1.41819;
   45    1.48571;
   56    1.48571;
   56    1.38283;
   70    1.38283;
   70    1.40715;
   82    1.40715;
   82    1.38571;
   94    1.38571;
   94    1.44285;
   99    1.44285;
   99    1.42250;
  112    1.42250;
  112    1.25590;
  116    1.19285;
  116    1.22644;
  126    1.22644;
  134    1.27144;
  140    1.27144;
  140    0.80327;
  153    0.80327;
  153    0.78571;
  154    0.78571;
  154    0.54004;
  167    0.54004;
  167    0.52144;
  182    0.52144;
  182    0.51429;
  196    0.51429;
  196    0.52846;
  210    0.52846;
  210    0.45267;
  224    0.45267;
  224    0.50715;
  230    0.50715;
  230    0.54927;
  238    0.54927;
  238    0.62856;
  239    0.62856;
  239    0.61429;
  253    0.61429;
  253    0.59794;
  266    0.59794;
  266    0.54285;
  272    0.54285;
  272    0.52856;
  285    0.52856;
  285    0.49285;
  295    0.49285;
  295    0.51100;
  308    0.51100;
  308    0.52431;
  322    0.52431;
  322    0.56429;
  331    0.56429;
  331    0.62092;
  336    0.62092;
  336    0.63571;
  350    0.63571;
  350    0.59285;
  358    0.59285;
  358    0.64512;
  364    0.64512;
  364    0.69285;
  371    0.69285;
  371    0.70715;
  385    0.70715;
  385    0.65923;
  392    0.65923;
  392    0.65000;
  407    0.65000;
  407    0.63262;
  420    0.63262;
  420    0.49285;
  425    0.49285;
  425    0.53302;
  434    0.53302;
  434    0.60000;
  437    0.60000;
  437    0.61429;
  451    0.61429;
  451    0.63571;
  463    0.63571;
  463    0.65625;
  476    0.65625;
  476    0.72144;
  480    0.72144;
  480    0.69000;
  490    0.69000;
  490    0.62856;
  494    0.62856;
  494    0.59340;
  504    0.59340;
  504    0.60565;
  518    0.60565;
  518    0.65000;
  526    0.65000;
  526    0.70225;
  532    0.70225;
  532    0.73571;
  542    0.73571;
  542    0.79888;
  546    0.79888;
  546    0.82856;
  557    0.82856;
  557    0.76167;
  560    0.76167;
  560    0.70715;
  566    0.70715;
  566    0.74923;
  574    0.74923;
  574    0.82144;
  576    0.82144;
  576    0.79700;
  588    0.79700;
  588    0.65715;
  593    0.65715;
  593    0.69721;
  602    0.69721;
  602    0.87713;
  616    0.87713;
  616    0.93571;
  621    0.93571;
  621    0.89769;
  630    0.89769;
  630    0.64777;
  644    0.64777;
  644    0.65125;
  648    0.65125;
  648    0.71429;
  658    0.71429;
  658    0.74787;
  670    0.74787;
  670    0.77144;
  674    0.77144;
  674    0.83571;
  686    0.83571;
  686    0.81365;
  694    0.81365;
  694    0.77144;
  700    0.77144;
  700    0.63571;
  714    0.63571;
  714    0.73433;
  728    0.73433;
  728    0.91425;
  740    0.91425;
  740    0.93571;
  742    0.93571;
  742    0.61065;
  755    0.61065;
  755    0.59285;
  756    0.59285;
  756    0.67169;
  763    0.67169;
  763    0.72144;
  779    0.72144;
  779    0.78160;
  784    0.78160;
  784    0.86492;
  792    0.86492;
  792    0.90715;
  806    0.90715;
  806    0.89285;
  813    0.89285;
  813    0.84285;
  826    0.84285;
  826    0.82615;
  840    0.82615;
  840    0.81283;
  854    0.81283;
  854    0.79952;
  864    0.79952;
  864    0.76429;
  873    0.76429;
  873    0.72856;
  882    0.72856;
  882    0.60629;
  891    0.60629;
  891    0.57144;
  905    0.57144;
  905    0.55715;
  910    0.55715;
  910    0.61790;
  924    0.61790;
  924    0.52833;
  930    0.52833;
  930    0.47856;
  938    0.47856;
  938    0.52542;
  943    0.52542;
  943    0.58571;
  952    0.58571;
  952    0.62204;
  959    0.62204;
  959    0.67144;
  966    0.67144;
  966    0.62421;
  969    0.62421;
  969    0.55715;
  980    0.55715;
  980    0.52758;
  994    0.52758;
  994    0.51429];

%% low feeding level 20/10 centigrade; time, survival, reprod
tNR_3 = [ ...
	 0 22 1.328571429;
	14 22 1.328571429;
	14 22 1.292857143;
	28 22 1.292857143;
	28 22 1.435714286;
	42 22 1.435714286;
	42 22 1.392857143;
	56 22 1.392857143;
	56 22 1.492857143;
	70 22 1.492857143;
	70 22 1.178571429;
	84 22 1.178571429;
	84 22 1.028571429;
	98 22 1.028571429;
	98 22 0.6142857143;
	112 22 0.6142857143;
	112 22 0.5785714286;
	126 22 0.5785714286;
	126 22 0.4642857143;
	140 22 0.4642857143;
	140 22 0.3642857143;
	154 22 0.3642857143;
	154 22 0.3857142857;
	168 22 0.3857142857;
	168 22 0.4571428571;
	182 22 0.4571428571;
	182 22 0.4642857143;
	196 22 0.4642857143;
	196 22 0.5642857143;
	210 22 0.5642857143;
	210 22 0.4714285714;
	224 22 0.4714285714;
	224 22 0.5857142857;
	238 22 0.5857142857;
	238 22 0.6071428571;
	252 22 0.6071428571;
	252 22 0.5214285714;
	266 22 0.5214285714;
	266 21 0.5785714286;
	280 21 0.5785714286;
	280 21 0.6;
	294 21 0.6;
	294 20 0.6571428571;
	308 20 0.6571428571;
	308 19 0.3714285714;
	322 19 0.3714285714;
	322 19 0.6857142857;
	336 19 0.6857142857;
	336 19 0.6642857143;
	350 19 0.6642857143;
	350 19 0.5571428571;
	378 19 0.5571428571;
	378 19 0.6857142857;
	392 19 0.6857142857;
	392 19 0.6071428571;
	406 19 0.6071428571;
	406 19 0.7071428571;
	420 19 0.7071428571;
	420 19 0.7785714286;
	434 19 0.7785714286;
	434 19 1.007142857;
	448 19 1.007142857;
        448 19 0.8785714286;
        462 19 0.8785714286;
	462 19 0.7928571429;
	476 19 0.7928571429;
	476 19 0.65;
	490 19 0.65;
	490 18 0.4571428571;
	504 18 0.4571428571;
	504 18 0.4214285714;
	518 18 0.4214285714;
	518 18 0.6214285714;
	532 18 0.6214285714;
	532 18 0.85;
	560 18 0.85;
	560 18 0.7357142857;
	574 18 0.7357142857;
	574 18 0.6928571429;
	588 18 0.6928571429;
	588 17 0.55;
	602 17 0.55;
	602 17 0.85;
	616 17 0.85;
	616 17 0.8285714286;
	630 17 0.8285714286;
	630 17 0.4857142857;
	644 17 0.4857142857;
	644 17 0.3857142857;
	658 17 0.3857142857;
	658 17 0.6571428571;
	672 17 0.6571428571;
	672 16 0.7928571429;
	686 16 0.7928571429;
	686 14 0.6357142857;
	700 14 0.6357142857;
	700 14 0.5785714286;
	714 14 0.5785714286;
	714 13 0.4142857143;
	728 13 0.4142857143;
	728 13 0.8357142857;
	742 13 0.8357142857;
	742 13 0.7714285714;
	756 13 0.7714285714;
	756 13 0.8928571429;
	770 13 0.8928571429;
	770 13 1.057142857;
	784 13 1.057142857;
	784 13 0.8428571429;
	798 13 0.8428571429;
	798 13 0.6571428571;
	812 13 0.6571428571;
	812 11 0.8285714286;
	826 11 0.8285714286;
	826 11 0.7285714286;
	840 11 0.7285714286;
	840 10 0.5357142857;
	854 10 0.5357142857;
	854 9 0.4928571429;
	868 9 0.4928571429;
	868 9 0.4785714286;
	882 9 0.4785714286;
	882 9 0.2928571429;
	896 9 0.2928571429;
	896 9 0.4357142857;
	910 9 0.4357142857;
	910 9 0.5857142857;
	924 9 0.5857142857;
	924 9 0.6285714286;
	938 9 0.6285714286;
	938 9 0.9214285714;
	952 9 0.9214285714;
	952 8 1.135714286;
	966 8 1.135714286;
	966 8 0.5785714286;
	980 8 0.5785714286;
	980 8 0.6;
	994 8 0.6];

tN_3 = tNR_3(:,[1 2]); tR_3 = tNR_3(:,[1 3]);

global tR

par_txt = {'N(0)'; 'N_rand'; 'h_rand'; 'ha kM/6'; 'ha e0/ kapR g l^3'};
tR = tR_1; p1 = [20 0 ; 2 0; 7.46 1; .0004 0; 0.63 1];
p1 = nmregr('survb',p1,tN_1);
[cov cor sd] = pregr('survb',p1,tN_1);
printpar(par_txt,p1,sd)

t = linspace(0,1000,101)';
N1 = survb(p1(:,1),t); q1 = p1; q1(1,1) = p1(1,1) - p1(2,1); q1(2,1) = 0;
N1a = survb(q1(:,1),t);

tR = tR_2; p2 = [22 0 ; 3 0; 3.9 1; .0001 0; 0.547 1];
p2 = nmregr('survb',p2,tN_2);
[cov cor sd] = pregr('survb',p2,tN_2);
printpar(par_txt,p2,sd)

N2 = survb(p2(:,1),t); q2 = p2; q2(1,1) = p2(1,1) - p2(2,1); q2(2,1) = 0;
N2a = survb(q2(:,1),t);

tR = tR_3; p3 = [22 0 ; 0 0; 0 0; .00004 0; 0.374 1];
p3 = nmregr('survb',p3,tN_3);
[cov cor sd] = pregr('survb',p3,tN_3);
printpar(par_txt,p3,sd)

N3 = survb(p3(:,1),t);

%% gset term postscript color solid 'Times-Roman' 35

subplot(1,2,1)
%% gset output 'ErnsIsaa91r.ps'
plot(tR_1(:,1), tR_1(:,2), 'r', ...
     tR_2(:,1), tR_2(:,2), 'g', ...
     tR_3(:,1), tR_3(:,2), 'b')
legend('high food, 20/10 C', 'high food, 10 C', 'low food, 20/10 C')
xlabel('time since eclosion, d')
ylabel('% of eggs/beetle, 1/d')


subplot(1,2,2)
%% gset output 'ErnsIsaa91.ps'
plot(tN_1(:,1), tN_1(:,2), 'r', ...
     tN_2(:,1), tN_2(:,2), 'g', ...
     tN_3(:,1), tN_3(:,2), 'b', ...
     t, N1, 'r', t, N1a, 'r', ...
     t, N2, 'g', t, N2a, 'g', ...
     t, N3, 'b')
legend('high food, 20/10 C', 'high food, 10 C', 'low food, 20/10 C')
xlabel('time since eclosion, d')
ylabel('% of survivors')