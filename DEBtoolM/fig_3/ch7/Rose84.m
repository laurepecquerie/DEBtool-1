%% fig:Rose84
%% bib:Rose84
%% out:Rose84

%% numbers of fruit flies at age

aN = [0 70.77051481;
      4.341732604 70.35549744;
      9.898463564 69.07293583;
      17.00289223 64.77311938;
      18.97904248 60.39256155;
      20.49269942 59.79294966;
      21.40871358 56.53576185;
      22.64133915 53.45647661;
      24.16190119 50.88659754;
      26.09763365 48.4436408;
      27.63583162 45.95630744;
      28.11015526 44.31094025;
      29.05115025 39.19913731;
      29.63458797 38.29734194;
      31.03649205 36.75552022;
      34.00852418 27.65977511;
      35.72017872 27.02441545;
      36.87935774 24.64146385;
      40.56751405 22.14206808;
      43.1369974 17.60460743;
      45.26364739 9.612817622;
      48.22041752 8.08341097;
      49.2847758 6.032843443;
      53.14243051 5.087464356;
      55.21194971 4.000326532;
      58.50120801 2.598942825;
      63.60393418 2.001224442;
      66.09390133 1.438284987;
      70.52659352 0.2037978579];

aN1 = [0 71.93305215;
       9.589820562 70.84532576;
       14.40231681 67.58296853;
       18.03460727 64.9957366;
       19.21165783 60.33015036;
       20.55546658 59.53744337;
       23.2093698 56.64978858;
       25.75817122 55.80823779;
       28.52374813 45.11949424;
       30.95173476 43.88378174;
       33.45775205 36.05117004;
       35.75788493 31.38728743;
       36.51674534 28.82139623;
       38.41305899 27.34533832;
       42.7208862 18.38419619;
       45.30245969 16.2725086;
       47.48388396 8.872902031;
       48.64496414 8.000152378;
       49.3717057 6.753858417;
       52.98294649 5.073836001;
       63.88543949 3.990386476;
       69.1001199 1.167955608];

aN2 = [0 70.55957302;
       9.461984763 69.13097484;
       12.19956967 66.55172921;
       14.69447038 62.99861969;
       15.75637775 60.17308632;
       19.3158777 55.53233957;
       22.08108519 52.45623806;
       23.73890994 48.10135754;
       25.83247628 44.20510304;
       27.64363352 38.73956384;
       28.90226566 35.72978555;
       32.08016897 29.53740314;
       32.79311929 28.10607123;
       33.8608284 22.81427401;
       36.73225009 18.8597586;
       37.95183214 16.81040952;
       39.52618037 15.38609911;
       42.79612725 13.01613541;
       43.75371276 9.744860967;
       44.67114798 7.334717863;
       47.61352586 5.299411772;
       50.07371867 4.593574435;
       51.13465054 3.174944269;
       54.04977258 1.669593343;
       59.66227057 0.06422043474];

nrregr_options('report',0);
p = [70 .0256]';
p = nrregr('weibull3', p, [aN; aN1; aN2]);
nrregr_options('report',1);

[cov cor sd] = pregr('weibull3', p, [aN; aN1; aN2]);
par_txt = {'N_0';'hazard'};
printpar(par_txt,p,sd)

t = linspace(0,70,100)';
N = weibull3(p, t);

%% gset term postscript color solid 'Times-Roman' 35
%% gset output 'Rose84.ps'

plot(aN(:,1), aN(:,2), '.g', aN1(:,1), aN1(:,2), '.b', aN2(:,1), aN2(:,2), '.m', t, N, 'r')
xlabel('age, d')
ylabel('numbers alive')
