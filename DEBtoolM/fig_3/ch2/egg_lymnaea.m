%% fig:egg_lymnaea
%% bib:Hors58
%% out:Hors58,Hors58r

%%  run this script from egg
%% Lymnaea stagnalis: dry weight (mug), yolk (galactogen, mug) and dioxygen cons (nl/d) at age (d)

aW = [9.76978  103.30694;
      8.99309   86.87736;
      8.62958   64.94358;
      7.97192   53.55773;
      7.95941   51.95272;
      7.28914   34.22324;
      7.00731   32.23672;
      6.55636   23.21942;
      6.30584   20.54525;
      6.13676   17.33574;
      5.98642   15.42562;
      5.28508   11.68229;
      4.98446    9.77217;
      4.87804    9.77217;
      4.43964    6.56317;
      4.43963    5.49351;
      4.25177    4.34743;
      4.15786    4.27103;
      4.04511    3.20136;
      3.96999    3.88951;
      3.92617    2.97215;
      3.77588    2.74344;
      3.59429    2.36193;
      3.20604    1.36917;
      2.67378    1.06457;
      1.97248    0.91278];

aY = [10.03401  27.543259;
      9.578838  31.693843;
      9.473421  27.804662;
      9.016417  36.166498;
      9.007709  30.052173;
      8.057402  32.646358;
      8.031231  37.012774;
      8.008681  42.030323;
      8.000156  38.973999;
      7.042469  44.777995;
      7.017994  35.809480;
      7.011211  43.681219;
      7.000257  38.670380;
      6.052378  49.284759;
      6.035420  47.734231;
      6.017820  41.521495;
      5.011275  52.147616;
      5.002979  50.645175;
      4.479655  42.477086;
      4.476675  46.488161;
      3.999780  55.806426;
      3.994372  57.862986;
      3.533014  50.284243;
      3.473110  47.037528;
      3.039252  55.043743;
      2.999239  50.840878;
      1.490957  51.138906;
      1.455528  50.795028;
      1.038262  63.309684;
      1.006637  57.601303;
      0.572137  48.813953;
      0.508291  46.370180;
      0.092400  53.069657;
      0.074204  60.392310];

aO2 = [9.819325  124.211042;
       9.052626  105.931499;
       8.611526   98.716691;
       7.991081   82.101158;
       7.982281   79.649748;
       7.362431   75.835077;
       7.003098   56.420374;
       6.607419   56.710441;
       6.356207   50.770217;
       6.151241   47.045291;
       6.041103   43.842805;
       5.887928   47.698608;
       5.505862   42.851343;
       5.230816   38.217755;
       5.227150   34.615693;
       5.033962   30.122597;
       5.009625   37.024902;
       5.008158   35.568693;
       4.511280   29.128999;
       4.388630   26.005039;
       4.278905   23.185570;
       3.999963   20.852216;
       3.999184   20.085649;
       3.754022   13.914120;
       3.677709   13.082916;
       3.175193    7.257543;
       3.092877    6.656576;
       2.966010    5.526224;
       2.832635    4.166704;
       2.719152    3.800782;
       2.485219    2.456753;
       2.189273    1.965295;
       2.063369    1.754823;
       1.748586    1.266037;
       1.559845    1.065180;
       1.371057    0.863790;
       1.176037    0.663467;
       0.937245    0.700327;
       0.691808    0.431094;
       0.465437    0.312503;
       0.333529    0.409192;
       0.062929    0.067308];

nrregr_options('report',1)
p = [10.1 0; 1 0; .1 0; 24975 1; 98647 1; .042 1; 1 0; 79249 1; 7709 1];
aY = [aY, .1 + 0 * aY(:,1)];
p = nrregr('embryoEVO',p, aY, aW, aO2);
[cov cor sd ssd] = pregr('embryoEVO',p, aY, aW, aO2);
printpar(nmEVO, p, sd); 
nrregr_options('report',1)

a = linspace(10,0,100)';
[Y W O2] = embryoEVO(p(:,1), a, a, a);

% clg; gset nokey

%% plotting

subplot(1,3,1);
%% gset output 'Hors58.ps'
plot(aY(:,1), aY(:,2), 'og', a, Y, 'r');
title('Lymnaea stagnalis')
xlabel('time, d');
ylabel('weight galactogen, mug');

subplot(1,3,2);
%% gset output 'Hors58a.ps'
plot(aW(:,1), aW(:,2), 'og', a, W, 'r');
title('Lymnaea stagnalis')
xlabel('time, d');
ylabel('weight structure, mug');

subplot(1,3,3);
%% gset output 'Hors58r.ps'
plot(aO2(:,1), aO2(:,2), 'og', a, O2, 'r');
title('Lymnaea stagnalis')
xlabel('time, d');
ylabel('O2 consumption, mul/h');

%% multiplot(0,0)
