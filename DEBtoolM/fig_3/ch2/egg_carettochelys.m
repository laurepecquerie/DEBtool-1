%% fig:egg_carettochelys
%% bib:WebbChoq86
%% out:WebbChoq86,WebbChoq86r
%%  run this script from egg
%% Carettochelys insculpta: wet weight, yolk and dioxygen consumption at age

aW = [24 0.42876;
      34 1.4436;
      44 4.6592;
      54 11.52261;
      64 16.93948;
      74 19.11912;
      84 19.67712;
      88.99 20.18744;
      89. 20.961];

aY = [0   13.93175;
      2.5 12.01861;
      4   9.23984;
      14  13.69786;
      24  13.86324;
      34  11.42048;
      44  11.18208;
      54  9.84456;
      64  4.87912;
      74  2.74659;
      84  1.28544;
      88.99  0.9912;
      89  1.33575];

aO2 = [14.97738138 4.721137638;
       21.16929769 5.561583302;
       21.18347466 6.531196534;
       22.28145638 7.662893676;
       22.57144073 6.363617655;
       27.06772364 10.10305934;
       33.21954836 13.48458282;
       34.89913242 20.05408802;
       34.96420248 19.22137637;
       38.02378205 22.43662335;
       39.82473002 26.74046848;
       40.73155212 30.64733293;
       40.78231467 31.47762269;
       43.65045117 29.52402098;
       43.98431659 31.22592878;
       45.85007353 39.96229154;
       45.86560068 41.02424889;
       46.84099885 41.69664734;
       50.92001057 59.1621072;
       51.67576465 63.30306113;
       52.11154682 58.76770452;
       52.90146957 70.52866272;
       54.62597909 59.0384346;
       54.84455645 63.42155099;
       56.4281467  66.0672385;
       56.81264413 71.23205069;
       58.71374467 63.89488596;
       58.76263484 75.16329017;
       59.34177555 61.94193544;
       59.6773828  55.83834343;
       59.8456116  64.7025714;
       60.14855328 61.64794985;
       60.7377122  64.96103591;
       61.67031839 67.98982394;
       61.69555794 64.43296083;
       61.7209504  71.45272834;
       62.69027273 71.70957826;
       63.72170366 76.21425758;
       64.63039814 69.68300758;
       66.5899707  71.62804124;
       67.05748226 69.26277138;
       68.67293245 71.44593101;
       68.75527149 63.8696769;
       71.05787734 60.21901119;
       71.87815694 60.84846677;
       73.11570773 47.75190416;
       73.67113434 61.96563256;
       73.75832957 52.07996822;
       75.56681177 41.04984609;
       75.74799789 48.15872853;
       77.43039052 39.07106206;
       79.55640535 31.26733296;
       80.23792151 43.5386057;
       80.91495077 37.01219949;
       81.32656012 28.18203412;
       81.49587801 42.40383548;
       81.55998953 33.58093579;
       83.39739255 40.3780721;
       83.41437807 25.69051366;
       83.4473271  30.58555917;
       83.47163047 32.24775329;
       85.49681764 36.03886199;
       86.23634712 25.86244125;
       86.33192693 24.4748576;
       86.54699828 31.25972833;
       87.32448589 34.24557349;
       87.50011837 30.40844884;
       88.31852559 41.47601887;
       89.48072702 17.94295641;
       91.29733269 20.67614425;
       91.47054824 24.59834735;
       92.21563138 25.3679337;
       92.27127249 37.09805849;
       94.37121976 22.22838982;
       94.51176974 29.19956338]; 

%% we must have decreasing times for embryo-data fitting
aW = aW(9:-1:1,:); aY = aY(13:-1:1,:); aO2 = aO2(75:-1:1,:);

nrregr_options('report',0)
aW = [aW, 10+0*aW(:,1)];
p = [95 0; .0836 0; .12 0; 5430 1; 11866 1; .0096 0; .961 0; 15320 1; 10354 1];
p = nrregr('embryoEVO',p, aY, aW, aO2);
[cov cor sd ssd] = pregr('embryoEVO',p, aY, aW, aO2);
printpar(nmEVO, p, sd); 
nrregr_options('report',1)

a = linspace(95,0,100)';
[Y W O2] = embryoEVO(p(:,1), a, a, a);
%% [eY eW eO2] = embryoEVO(p(:,1), aY, aW, aO2);
%% [aY eY]
%% [aW eW]

%% gset term postscript color solid 'Times-Roman' 35
%% gset nokey

%% multiplot(1,3)
subplot(1,3,1);
%% gset output 'WebbChoq86.ps'
plot(aY(:,1), aY(:,2), 'og', a, Y, 'r');
title('Carettochelys insculpta')
xlabel('time, d');
ylabel('wet weight yolk, g');

subplot(1,3,2);
%% gset output 'WebbChoq86a.ps'
plot(aW(:,1), aW(:,2), 'og', a, W, 'r');
title('Carettochelys insculpta')
xlabel('time, d');
ylabel('wet weight structure, g');

subplot(1,3,3);
%% gset output 'WebbChoq86r.ps'
plot(aO2(:,1), aO2(:,2), 'og', a, O2, 'r');
title('Carettochelys insculpta')
xlabel('time, d');
ylabel('O2 consumption, ml/d');

%% multiplot(0,0)
